<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Employee ID Card & QR Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1.2fr 1fr;
      gap: 20px;
    }
    .box {
      background: #ffffff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      font-size: 14px;
      margin-top: 8px;
    }
    input, textarea {
      width: 100%;
      padding: 6px 8px;
      margin-top: 3px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
      box-sizing: border-box;
    }
    textarea {
      resize: vertical;
      min-height: 50px;
    }
    button {
      margin-top: 15px;
      padding: 10px 18px;
      border: none;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      background: #2563eb;
      color: #fff;
    }
    button:hover {
      background: #1d4ed8;
    }
    .id-card-wrapper {
      display: flex;
      justify-content: center;
    }
    .id-card {
      width: 360px;
      border-radius: 12px;
      border: 2px solid #111827;
      overflow: hidden;
      background: #e5f0ff;
      display: flex;
      flex-direction: column;
      font-size: 13px;
    }
    .id-header {
      background: #111827;
      color: #fff;
      text-align: center;
      padding: 8px;
      font-weight: bold;
      font-size: 15px;
    }
    .id-body {
      display: grid;
      grid-template-columns: 1fr 2fr;
      padding: 10px;
      gap: 8px;
    }
    .id-photo-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    .id-photo-box img {
      width: 110px;
      height: 130px;
      object-fit: cover;
      border-radius: 6px;
      border: 1px solid #4b5563;
      background: #fff;
    }
    .id-details {
      font-size: 12px;
      line-height: 1.5;
    }
    .id-row {
      margin-bottom: 4px;
      display: flex;
    }
    .label {
      font-weight: bold;
      width: 90px;
    }
    .id-footer {
      border-top: 1px solid #9ca3af;
      padding: 6px 10px 10px;
      display: flex;
      justify-content: space-between;
      font-size: 11px;
    }
    .sign-block {
      text-align: center;
      width: 48%;
    }
    .sign-block img {
      width: 110px;
      height: 40px;
      object-fit: contain;
      border-bottom: 1px solid #4b5563;
      background: #fff;
    }
    .sign-label {
      margin-top: 2px;
    }
    #qrcode {
      margin-top: 10px;
      display: flex;
      justify-content: center;
    }
    .note {
      font-size: 12px;
      color: #6b7280;
      margin-top: 6px;
    }
    @media (max-width: 900px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <h1>Employee ID Card & QR Code Generator</h1>

  <div class="container">
    <!-- Left: Form -->
    <div class="box">
      <h2>Enter Employee Details</h2>

      <label>Card Number</label>
      <input type="text" id="cardNo" />

      <label>Employee Name</label>
      <input type="text" id="name" />

      <label>Designation</label>
      <input type="text" id="designation" />

      <label>Department</label>
      <input type="text" id="department" />

      <label>Employee ID</label>
      <input type="text" id="employeeId" />

      <label>Date of Birth</label>
      <input type="date" id="dob" />

      <label>Address</label>
      <textarea id="address"></textarea>

      <label>Identification Mark</label>
      <input type="text" id="idMark" />

      <label>Blood Group</label>
      <input type="text" id="bloodGroup" />

      <label>Issue Date</label>
      <input type="date" id="issueDate" />

      <label>Validity (Till Date)</label>
      <input type="date" id="validity" />

      <hr />
      <h3>Photo & Signatures (Image URLs)</h3>
      <p class="note">
        Just paste the normal GitHub image link (the long one with <b>blob/main</b>).  
        The website will automatically convert it to the correct RAW link.
      </p>

      <label>Employee Photograph URL</label>
      <input type="text" id="photoUrl" />

      <label>Employee Signature URL</label>
      <input type="text" id="empSignUrl" />

      <label>Issuing Authority Signature URL</label>
      <input type="text" id="authSignUrl" />

      <button onclick="generateCardAndQR()">Generate Card & QR</button>
    </div>

    <!-- Right: Preview & QR -->
    <div class="box">
      <h2>Preview & QR Code</h2>

      <div class="id-card-wrapper">
        <div class="id-card" id="id-card">
          <div class="id-header">EMPLOYEE ID CARD</div>
          <div class="id-body">
            <div class="id-photo-box">
              <img id="displayPhoto" src="" alt="Employee Photo" />
            </div>
            <div class="id-details">
              <div class="id-row"><span class="label">Card No:</span><span id="displayCardNo"></span></div>
              <div class="id-row"><span class="label">Name:</span><span id="displayName"></span></div>
              <div class="id-row"><span class="label">Designation:</span><span id="displayDesignation"></span></div>
              <div class="id-row"><span class="label">Department:</span><span id="displayDepartment"></span></div>
              <div class="id-row"><span class="label">Employee ID:</span><span id="displayEmployeeId"></span></div>
              <div class="id-row"><span class="label">DOB:</span><span id="displayDob"></span></div>
              <div class="id-row"><span class="label">Blood Group:</span><span id="displayBloodGroup"></span></div>
              <div class="id-row"><span class="label">Issue Date:</span><span id="displayIssueDate"></span></div>
              <div class="id-row"><span class="label">Valid Till:</span><span id="displayValidity"></span></div>
              <div class="id-row"><span class="label">ID Mark:</span><span id="displayIdMark"></span></div>
              <div class="id-row"><span class="label">Address:</span><span id="displayAddress"></span></div>
            </div>
          </div>
          <div class="id-footer">
            <div class="sign-block">
              <img id="displayEmpSign" src="" alt="Employee Signature" />
              <div class="sign-label">Employee Signature</div>
            </div>
            <div class="sign-block">
              <img id="displayAuthSign" src="" alt="Authority Signature" />
              <div class="sign-label">Issuing Authority</div>
            </div>
          </div>
        </div>
      </div>

      <h3 style="text-align:center; margin-top:15px;">QR Code</h3>
      <div id="qrcode"></div>

      <!-- Show link inside the QR -->
      <p class="note" style="text-align:center; margin-top:8px;">QR link (you can copy/share this):</p>
      <input id="qrLink" readonly style="width:100%; font-size:10px; padding:4px;">

      <p class="note" style="text-align:center;">
        Scan this QR with a mobile. It will open the clean ID card page with all details & photos.
      </p>
    </div>
  </div>

  <script>
    function normalizeImageUrl(url) {
      if (!url) return "";
      url = url.trim();
      if (url.includes("github.com") && url.includes("/blob/")) {
        url = url.replace("https://github.com/", "https://raw.githubusercontent.com/");
        url = url.replace("/blob/", "/");
      }
      return url;
    }

    function fillCardFromData(data) {
      document.getElementById('displayCardNo').textContent = data.cardNo || "";
      document.getElementById('displayName').textContent = data.name || "";
      document.getElementById('displayDesignation').textContent = data.designation || "";
      document.getElementById('displayDepartment').textContent = data.department || "";
      document.getElementById('displayEmployeeId').textContent = data.employeeId || "";
      document.getElementById('displayDob').textContent = data.dob || "";
      document.getElementById('displayBloodGroup').textContent = data.bloodGroup || "";
      document.getElementById('displayIssueDate').textContent = data.issueDate || "";
      document.getElementById('displayValidity').textContent = data.validity || "";
      document.getElementById('displayIdMark').textContent = data.idMark || "";
      document.getElementById('displayAddress').textContent = data.address || "";

      document.getElementById('displayPhoto').src = data.photoUrl || "";
      document.getElementById('displayEmpSign').src = data.empSignUrl || "";
      document.getElementById('displayAuthSign').src = data.authSignUrl || "";
    }

    function generateCardAndQR() {
      const data = {
        cardNo: document.getElementById('cardNo').value,
        name: document.getElementById('name').value,
        designation: document.getElementById('designation').value,
        department: document.getElementById('department').value,
        employeeId: document.getElementById('employeeId').value,
        dob: document.getElementById('dob').value,
        address: document.getElementById('address').value,
        idMark: document.getElementById('idMark').value,
        bloodGroup: document.getElementById('bloodGroup').value,
        issueDate: document.getElementById('issueDate').value,
        validity: document.getElementById('validity').value,
        photoUrl: normalizeImageUrl(document.getElementById('photoUrl').value),
        empSignUrl: normalizeImageUrl(document.getElementById('empSignUrl').value),
        authSignUrl: normalizeImageUrl(document.getElementById('authSignUrl').value)
      };

      fillCardFromData(data);

      const json = JSON.stringify(data);
      const baseUrl = "https://jeeyar24.github.io/idcard/view.html";
      const fullUrl = baseUrl + "?data=" + encodeURIComponent(json);

      const qrDiv = document.getElementById("qrcode");
      qrDiv.innerHTML = "";
      new QRCode(qrDiv, {
        text: fullUrl,
        width: 260,
        height: 260,
        correctLevel: QRCode.CorrectLevel.M
      });

      const qrLinkInput = document.getElementById("qrLink");
      if (qrLinkInput) qrLinkInput.value = fullUrl;
    }
  </script>
</body>
</html>
